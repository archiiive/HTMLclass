package i;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class I07_JDBC2 {
	public static void main(String[] args) {
		
		//select 처리
		
		//객체생성
		Connection conn = null;
		Statement stmt = null;
		ResultSet rs = null;
		
		try {
			Class.forName("com.mysql.cj.jdbc.Driver");
			
			conn =DriverManager.getConnection("jdbc:mysql://localhost:3306/testdb?serverTimezone=Asia/Seoul","root","!qwe123");
			//3.Statement작성
			stmt = conn.createStatement();
			
			//4.SQl작성
			String sql = "select * from Persons";
			//5 statement 객체를 통한 동작 - excuteQuery() -> result 객체
			rs = stmt.executeQuery(sql);
			
			while(rs.next()) {
				int id = rs.getInt("id");
				String firstname  = rs.getString("firstname");
				String lastname = rs.getString("lastname");
				int age = rs.getInt("age");
				String city = rs.getString("city");
				
				System.out.printf("id : %d, 성 : %s, 이름 :%s ,나이 : %d, 도시 : %s \n",
						id,firstname,lastname,age,city);
				
			}
			//입력값을 방아서 해당결과를 출력하는 프로그램을 만드세요
			//1.id값을 받아 출력 - 결과가 없으면 없다고 출력하세요.
			//2.이름을 통한 내용을 출력 - 단, 이름에 일부를 입력해도 출력해야합니다.
			
			
			
			
		} catch (ClassNotFoundException ce) {
			// TODO: handle exception
			System.out.println("드라이버 연동실패");
		}catch (SQLException e) {
		System.out.println("SQL연동 실패");
		System.out.println(e.getMessage());
			// TODO: handle exception
		}finally {
			try {
				if(conn != null)conn.close();
				if(stmt != null)stmt.close();
			} catch (Exception e2) {
				// TODO: handle exception
			}
		}
		
		
		
	}

}
