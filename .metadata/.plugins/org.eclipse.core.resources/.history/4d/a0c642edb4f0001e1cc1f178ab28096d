import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class I09_sqlliteDB {

	public static void main(String[] args) {
		// TODO Auto-generated method stub
		
		
		
		//sql연결하기
		Connection conn = null;
		Statement stmt = null;
		ResultSet rs = null;
		
	try {
		Class.forName("org.sqlite.JDBC");
		String dbfile ="SQLlite.db";//실제 db이 있는
		String url ="jdbc:sqlite:"+dbfile;
		//url -> jdbc:sqlite:SQLiteDB.db
		
		conn = DriverManager.getConnection(url);
		System.out.println("DB정상동작에 문제가 없어");
		//3.객체생성
		stmt = conn.createStatement();
		String sql  ="create table if not exists test_table("
															+"id int primary key,"
															+"lastNmae text(20) not null,"
															+"firstName text(20),"
															+"age numeric,"
															+ "city text(20) default 'seoul')";
															
		
		
		int result = stmt.executeUpdate(sql);
		System.out.println("sql 처리 결과"+result);
		
		
		//CRUD 테스트

		String insertsql1 = "insert into test_talble(id,lastname,firstname,age,city)values"
				+"(1,'test1','test1',11,'daegu'";
		stmt = conn.createStatement();
		rs = stmt.executeQuery(insertsql1);
		while(rs.next());{
			System.out.println("id : "+rs.getInt("id")+", lastname : "+rs.getString("lastname")+
					", firstname : "+rs.getString("firstname")+", age : " +
					rs.getInt("age")+", city : "+ rs.getString("city"));
	
		}stmt.close();
		
		//update
		String updateSql = "select * from test_table id = 1";
		stmt = conn.createStatement(updateSql);
		
				
		
				
				
				
				
				
				
		//delete		
		String deleteSql = "delete form test_table where id = 1";
		stmt = conn.createStatement();
		result = stmt.executeUpdate(deleteSql);
		System.out.println("삭제 처리결과"+result);
				stmt.close();
				
		
		
		
	} catch (ClassNotFoundException ce) {
		System.out.println("드라이버 로드실패");
		
	}catch (SQLException sqle) {
		System.out.println("sql failed");
		System.out.println(sqle.getMessage());
	}	finally {
		try {
			
		} catch (Exception e2) {
			// TODO: handle exception
		}
	}

	}

}
